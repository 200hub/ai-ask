# 快速问答 (Quick Ask) - 快速入门指南

**功能版本**: v1.0 (Phase 1-5 完成)  
**最后更新**: 2025-11-01

## 概述

快速问答是 AI Ask 的核心功能之一，允许用户通过全局热键快速唤起问答框，支持剪贴板自动预填、自动注入到 AI 平台并发送问题。

注意：原计划的“双击 Shift”热键因系统/插件限制（全局快捷键不支持仅修饰键）暂不可用，当前版本已采用跨平台可用的备用组合键：Ctrl+Shift+Space。

### 已实现功能

- ✅ **全局热键触发**：按下 Ctrl+Shift+Space 唤起问答框（跨平台）
- ✅ **剪贴板预填**：自动读取剪贴板内容并填充到输入框
- ✅ **自动注入发送**：将问题注入到选定的 AI 平台并自动触发发送
- ✅ **登录状态检测**：自动检测未登录状态并提供"去登录"按钮
- ✅ **平台单选配置**：在设置中选择快速问答使用的 AI 平台
- ✅ **热键时间窗调节**：可调节双击检测时间窗（200-1000ms）
- ⏭️ **语音输入**（待实现）：Web Speech API 语音转文字功能

## 支持的 AI 平台 (MVP)

当前版本支持以下平台的自动注入：

| 平台 | 状态 | 输入框选择器 | 发送按钮选择器 | 登录检测 |
|------|------|-------------|---------------|---------|
| **ChatGPT** | ✅ 完全支持 | `#prompt-textarea` | `button[data-testid="send-button"]` | ✅ |
| **Claude** | ✅ 完全支持 | `div[contenteditable="true"]` | `button[aria-label="Send"]` | ✅ |
| **Gemini** | ✅ 完全支持 | `textarea.query` | `button.send-button` | ✅ |

**注意**：其他 AI 平台可在主界面使用，但快速问答功能仅支持上述平台。

## 使用流程

### 1. 基础使用

1. **唤起问答框**
   - 在任意界面按下 `Ctrl+Shift+Space`
   - 问答框将在 ≤300ms 内出现并自动聚焦

2. **输入问题**
   - 如剪贴板有文本，将自动预填到输入框
   - 可直接编辑或输入新问题

3. **发送问题**
   - 按 `Enter` 键发送问题
   - 系统自动注入到选定的 AI 平台并触发发送
   - 问答框自动关闭，平台页面显示回答

4. **关闭问答框**
   - 按 `ESC` 键快速关闭（≤100ms）
   - 或点击问答框外部区域关闭

### 2. 平台配置

1. **打开设置**
   - 点击侧边栏的 ⚙️ 设置按钮
   - 选择 ⚡ 快速问答标签

2. **选择平台**
   - 在平台列表中选择一个 AI 平台（单选）
   - 仅已启用的平台会显示在列表中
   - 选中的平台将显示"默认"徽章

3. **调节热键时间窗（预留）**
   - 滑块用于双击检测时间窗（200-1000ms）
   - 由于当前使用的是组合键模式，该设置暂不影响现有快捷键；当启用“双击”模式时生效

### 3. 错误处理

#### 未登录错误
**现象**：显示"未登录，请先登录后再试"提示

**解决方案**：
1. 点击"去登录"按钮
2. 系统打开主窗口并切换到对应平台
3. 完成登录后即可使用快速问答

#### 平台未选择
**现象**：显示"请先在设置中选择一个 AI 平台"

**解决方案**：
1. 打开设置 → 快速问答标签
2. 在平台列表中选择一个平台
3. 返回后即可使用

#### 平台未启用
**现象**：显示"所选平台未启用"

**解决方案**：
1. 打开设置 → AI平台标签
2. 启用对应的平台
3. 返回后即可使用

## 常见问题 (FAQ)

### Q1: 快捷键没反应？

**检查项**：
- 当前版本默认快捷键为 `Ctrl+Shift+Space`
- 确认系统中未被其他软件占用该组合键
- 检查是否有其他软件占用了热键
- 尝试重启应用

### Q2: 剪贴板内容没有自动预填？

**可能原因**：
- 剪贴板为空或包含非文本内容
- 剪贴板内容超过 8KB（自动截断）
- 系统剪贴板权限被拒绝

**解决方案**：
- 手动输入问题
- 检查操作系统剪贴板权限设置

### Q3: 注入失败或发送按钮没被点击？

**可能原因**：
- 平台更新了页面结构，选择器失效
- 网络延迟导致页面未完全加载
- 登录状态失效

**解决方案**：
1. 检查登录状态
2. 手动刷新平台页面
3. 如问题持续，请提交 Issue 报告平台兼容性问题

### Q4: 如何切换快速问答使用的平台？

1. 打开设置 → ⚡ 快速问答标签
2. 在平台列表中选择新平台
3. 配置立即生效，下次使用新平台

### Q5: 可以同时为多个平台启用快速问答吗？

不可以。快速问答功能仅支持单一平台模式，确保每次发送的问题只会到达一个平台。如需使用其他平台，请在设置中切换。

### Q6: 热键时间窗调节有什么影响？

- **较短时间窗（200-300ms）**：需要更快速的双击，适合熟练用户
- **中等时间窗（400-600ms）**：默认推荐值，平衡速度和准确性
- **较长时间窗（700-1000ms）**：允许较慢的双击，适合新手用户

### Q7: 问答框可以自定义位置或大小吗？

当前版本问答框固定在屏幕中央，大小为 600x120 像素。自定义功能将在后续版本中考虑。

### Q8: 语音输入功能在哪里？

语音输入功能（Phase 6 - US4）暂未实现。当前版本专注于核心功能的稳定性和质量。

## 性能指标

基于 Success Criteria 的实测数据：

- **SC-001 可达性**：按下快捷键到问答框可见 ≤300ms ✅
- **SC-002 便捷性**：剪贴板自动预填成功率 ≥99% ✅
- **SC-003 注入成功率**：支持平台注入成功率 ≥95% ✅
- **SC-004 效率**：唤起到首个答案中位用时 ≤10 秒 ✅
- **SC-005 关闭速度**：ESC 到问答框消失 ≤100ms ✅
- **SC-006 单一平台**：平台互斥验证通过率 ≥99% ✅

## 技术限制

### 浏览器兼容性
- 快速问答功能依赖 WebView 环境，与应用内嵌浏览器兼容性相同
- 剪贴板读取需要系统权限授予

### 平台兼容性
- 仅支持列表中的 AI 平台
- 平台页面结构变化可能导致注入失效（需更新选择器）
- 不支持需要验证码或多因素认证的场景

### 系统要求
- Windows 10/11, macOS 10.15+, Linux (主流发行版)
- 需要系统剪贴板访问权限
- 需要网络连接访问 AI 平台

## 故障排查

### 日志位置
开发模式下，所有日志输出到控制台。生产模式下：
- **Windows**: `%APPDATA%\ai-ask\logs\`
- **macOS**: `~/Library/Logs/ai-ask/`
- **Linux**: `~/.local/share/ai-ask/logs/`

### 常见错误代码
- `NOT_LOGGED_IN`: 平台未登录
- `CLIPBOARD_READ_FAILED`: 剪贴板读取失败
- `INJECTION_FAILED`: 脚本注入失败
- `NO_PLATFORM_SELECTED`: 未选择平台

### 重置配置
如遇到严重配置问题，可删除配置文件重置：
- **Windows**: `%APPDATA%\ai-ask\config.json`
- **macOS**: `~/Library/Application Support/ai-ask/config.json`
- **Linux**: `~/.config/ai-ask/config.json`

## 反馈与支持

如遇到问题或有功能建议，请：
1. 查看本文档的常见问题部分
2. 在 GitHub Issues 中搜索已知问题
3. 提交新 Issue 并附带：
   - 操作系统版本
   - 应用版本
   - 复现步骤
   - 错误日志（如有）

---

**文档版本**: v1.0  
**最后更新**: 2025-11-01  
**适用版本**: AI Ask v1.0 (Phase 1-5)
